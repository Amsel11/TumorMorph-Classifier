# TumorMorphology Classifier

This repository contains the `TumorMorphology` framework — a GPU-accelerated morphological analysis pipeline for evaluating brain tumor structure, shape, and lesion-level progression from longitudinal segmentation data.

It provides high-resolution morphological features such as fractal dimension, lacunarity, surface area, and compactness, with fine-grained per-lesion analysis and change tracking across timepoints. These features are intended to support downstream prediction tasks such as treatment response classification (e.g., RANO categories), progression modeling, and biomarker discovery.

## Features

- ✅ **GPU-Accelerated 3D Box Counting** for Fractal Dimension and Lacunarity
- ✅ **Lesion-Level Analysis**: per-lesion volume, surface area, compactness, fractal features
- ✅ **Longitudinal Change Tracking**: new vs. lost lesions, per-region activity, response trends
- ✅ **Unified Interface**: handles baseline and follow-up segmentations jointly
- ✅ **Robust Outputs**: designed for downstream ML pipelines, statistical modeling, or visualization

## Code Structure

- `MorphFeatureClass.py` – Core class `TumorMorphology` with all morphological and lesion analysis methods
- `extract_features.py` – Utility to extract selected features from segmentation pairs
- `models/` – Model checkpoints (not tracked in Git)
- `data/` – Raw segmentations and feature outputs (not tracked in Git)

## Input Segmentations

This framework assumes the availability of 3D tumor segmentation masks from baseline and follow-up MRI scans.

In our experiments, we use segmentations generated by **Swin-UNETR**, a 3D transformer-based model trained for brain tumor segmentation:

> Tang, Yucheng, et al. “Self-supervised pre-training of Swin Transformers for 3D medical image analysis.” *CVPR 2022*.  
> GitHub: [Project-MONAI/Swin-UNETR](https://github.com/Project-MONAI/research-contributions/tree/main/research-contributions/swin-unetr)

You may replace these with any other segmentations conforming to BraTS label conventions:
- 1 = enhancing tumor
- 2 = necrotic core
- 3 = edema

## Example Usage

```python
from MorphFeatureClass import TumorMorphology
import nibabel as nib

morph = TumorMorphology(use_gpu=True)

seg1 = nib.load('baseline_seg.nii.gz').get_fdata().astype(int)
seg2 = nib.load('followup_seg.nii.gz').get_fdata().astype(int)

results = morph.calculate_complete_morphology_with_lesions(seg1, seg2)
